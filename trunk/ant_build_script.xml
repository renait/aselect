<?xml version="1.0"?>

<!-- Johan Stuyts - JavaThinker                               -->
<!-- A script for Ant. To use it you have to:                 -->
<!-- Put the sources in 'src/org'                             -->
<!-- Put the dependencies in 'lib' or 'lib-compile            -->
<!-- The result will end up in 'target'                       -->
<!-- Use 'ant jars' to build the JAR files.                   -->
<!-- Bauke Hiemstra - www.anoigo.nl: Adapted for A-Select 1.6 -->

<project name="A-Select 1.6" default="jars">

  <macrodef name="build-jar">
    <attribute name="jar-name" />
    <attribute name="include-pattern" />
    <attribute name="exclude-pattern-1" default="" />
    <attribute name="exclude-pattern-2" default="" />
    <attribute name="exclude-pattern-3" default="" />
    <attribute name="exclude-pattern-4" default="" />
    <attribute name="exclude-pattern-5" default="" />
    <attribute name="exclude-pattern-6" default="" />
    <attribute name="exclude-pattern-7" default="" />
    <attribute name="exclude-pattern-8" default="" />
    <attribute name="exclude-pattern-9" default="" />
    <sequential>
      <jar basedir="target/classes" destfile="target/org.aselect.@{jar-name}-1.6.jar">
        <include name="@{include-pattern}" />
        <exclude name="@{exclude-pattern-1}" />
        <exclude name="@{exclude-pattern-2}" />
        <exclude name="@{exclude-pattern-3}" />
        <exclude name="@{exclude-pattern-4}" />
        <exclude name="@{exclude-pattern-5}" />
        <exclude name="@{exclude-pattern-6}" />
        <exclude name="@{exclude-pattern-7}" />
        <exclude name="@{exclude-pattern-8}" />
        <exclude name="@{exclude-pattern-9}" />
      </jar>
    </sequential>
  </macrodef>

  <target name="clean" description="Delete all build artifacts.">
    <delete includeemptydirs="true">
      <fileset dir="target">
        <include name="**" />
        <exclude name="eclipse/**" />
      </fileset>
    </delete>
    <mkdir dir="target" />
  </target>

  <target name="compile" description="Compile the Java files.">
    <mkdir dir="target/classes" />

    <javac destdir="target/classes" optimize="true" debug="true" debuglevel="vars" srcdir="src/org" sourcepath="">
      <classpath>
        <fileset dir="lib">
          <include name="*.jar" />
        </fileset>
        <fileset dir="lib-compile">
          <include name="*.jar" />
        </fileset>
      </classpath>
    </javac>
  </target>

  <target name="jars" description="Build the JAR files." depends="compile">
    <build-jar jar-name="agent" include-pattern="org/aselect/agent/**/*.class" />
    <build-jar jar-name="authsp.ip" include-pattern="org/aselect/authspserver/authsp/ip/**/*.class" />
    <build-jar jar-name="authsp.ldap" include-pattern="org/aselect/authspserver/authsp/ldap/**/*.class" />
    <build-jar jar-name="authsp.null" include-pattern="org/aselect/authspserver/authsp/nullauthsp/**/*.class" />
    <build-jar jar-name="authsp.pki" include-pattern="org/aselect/authspserver/authsp/pki/**/*.class" />
    <build-jar jar-name="authsp.radius" include-pattern="org/aselect/authspserver/authsp/radius/**/*.class" />
    <build-jar jar-name="authsp.sms" include-pattern="org/aselect/authspserver/authsp/sms/**/*.class" />
    <build-jar jar-name="authspserver"
               include-pattern="org/aselect/authspserver/**/*.class"
               exclude-pattern-1="org/aselect/authspserver/authsp/**/*.class" />
    <build-jar jar-name="server.attributes.requestors.api"
               include-pattern="org/aselect/server/attributes/requestors/api/**/*.class" />
    <build-jar jar-name="server.attributes.requestors.flatfile"
               include-pattern="org/aselect/server/attributes/requestors/flatfile/**/*.class" />
    <build-jar jar-name="server.attributes.requestors.jndi"
               include-pattern="org/aselect/server/attributes/requestors/jndi/**/*.class" />
    <build-jar jar-name="server.attributes.requestors.opaque"
               include-pattern="org/aselect/server/attributes/requestors/opaque/**/*.class" />
    <build-jar jar-name="server.attributes.requestors.tgt"
               include-pattern="org/aselect/server/attributes/requestors/tgt/**/*.class" />
    <build-jar jar-name="server.authsphandler.ip"
               include-pattern="org/aselect/server/authspprotocol/handler/IP.class" />
    <build-jar jar-name="server.authsphandler.ldap"
               include-pattern="org/aselect/server/authspprotocol/handler/Ldap.class" />
    <build-jar jar-name="server.authsphandler.nullauthsp"
               include-pattern="org/aselect/server/authspprotocol/handler/NullAuthSP.class" />
    <build-jar jar-name="server.authsphandler.pki"
               include-pattern="org/aselect/server/authspprotocol/handler/PKI.class" />
    <build-jar jar-name="server.authsphandler.radius"
               include-pattern="org/aselect/server/authspprotocol/handler/Radius.class" />
    <build-jar jar-name="server.authsphandler.smd"
               include-pattern="org/aselect/server/authspprotocol/handler/SMSAuthSPHandler.class" />
    <build-jar jar-name="server"
               include-pattern="org/aselect/server/**/*.class"
               exclude-pattern-1="org/aselect/server/attributes/requestors/*/**/*.class"
               exclude-pattern-2="org/aselect/server/authspprotocol/handler/*.class"
               exclude-pattern-3="org/aselect/server/request/handler/*/**/*.class"
               exclude-pattern-4="org/aselect/server/udb/*/**/*.class" />
    <build-jar jar-name="server.request.handler.aselect"
               include-pattern="org/aselect/server/request/handler/aselect/**/*.class" />
    <build-jar jar-name="server.request.handler.saml11"
               include-pattern="org/aselect/server/request/handler/saml11/**/*.class" />
    <build-jar jar-name="server.request.handler.shibboleth"
               include-pattern="org/aselect/server/request/handler/shibboleth/**/*.class" />
    <build-jar jar-name="server.request.handler.xsaml20"
               include-pattern="org/aselect/server/request/handler/xsaml20/**/*.class" />
    <build-jar jar-name="server.request.handler.wsfed"
               include-pattern="org/aselect/server/request/handler/wsfed/**/*.class" />
    <build-jar jar-name="system" include-pattern="org/aselect/system/**/*.class" />
    <build-jar jar-name="udb.flatfile" include-pattern="org/aselect/server/udb/flatfile/**/*.class" />
    <build-jar jar-name="udb.jdbc" include-pattern="org/aselect/server/udb/jdbc/**/*.class" />
    <build-jar jar-name="udb.jndi" include-pattern="org/aselect/server/udb/jndi/**/*.class" />
    <build-jar jar-name="udb.nodb" include-pattern="org/aselect/server/udb/nodb/**/*.class" />
    <build-jar jar-name="udb.sasdb" include-pattern="org/aselect/server/udb/sasdb/**/*.class" />
  </target>
</project>
